<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Checklist Preoperacional - Combuses</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0d6efd" />
  <style>
    :root{
      --bg: linear-gradient(135deg,#eef2ff 0%,#f7f9ff 50%,#eef6ff 100%);
      --ink:#0b1022; --muted:#6b7280; --card:#ffffff; --ring:#dbe4ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; padding:0}
    body{
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg); color:var(--ink);
      overflow-x: hidden;
    }
    header{
      position:sticky; top:0; background:rgba(255,255,255,.95); backdrop-filter:blur(8px);
      border-bottom:1px solid #e5e7eb; padding:15px 20px; z-index:100;
      box-shadow:0 2px 10px rgba(0,0,0,0.05);
    }
    .title{
      font-weight:700; font-size:1.3em; color:#1e40af;
      text-align:center;
    }
    .wrap{
      width:100%; max-width:1200px; margin:0 auto; padding:10px;
    }
    .frame-wrap{
      background:var(--card); border:1px solid #e5e7eb; border-radius:20px;
      box-shadow:0 15px 35px rgba(2,8,20,.1); overflow:hidden;
      position:relative;
      margin-top:15px;
    }
    iframe{
      display:block; width:100%; border:0;
      min-height:600px;
      height:100vh;
    }
    .loader{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,255,255,.8));
      transition:opacity .3s ease; pointer-events:none;
      z-index:10;
    }
    body.ready .loader{ opacity:0; }
    .spinner{
      width:48px; height:48px; border-radius:50%;
      border:4px solid #c7d2fe; border-top-color:#4f46e5; animation:spin 1s linear infinite;
    }
    @keyframes spin { to { transform:rotate(360deg) } }
    
    /* Footer */
    .footer{
      text-align:center; padding:20px; color:var(--muted); font-size:0.9em;
      margin-top:20px; border-top:1px solid #e5e7eb;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .wrap {
        padding:5px;
      }
      .frame-wrap {
        border-radius:12px;
        margin-top:10px;
      }
      header{
        padding:12px 15px;
      }
      .title{
        font-size:1.2em;
      }
      iframe {
        min-height:calc(100vh - 70px);
        height:auto;
      }
    }
    
    @media (max-width: 480px) {
      .frame-wrap {
        border-radius:0;
        border:none;
        box-shadow:none;
        margin-top:5px;
      }
      .wrap{
        padding:0;
      }
      iframe {
        min-height:calc(100vh - 60px);
      }
    }
    
    /* Scroll suave para m√≥viles */
    .frame-wrap, iframe {
      -webkit-overflow-scrolling: touch !important;
    }
  </style>
</head>
<body>
  <header>
    <div class="title">üöó CHECKLIST PREOPERACIONAL - COMBUSES</div>
  </header>

  <main class="wrap">
    <div class="frame-wrap">
      <div class="loader">
        <div class="spinner" aria-label="Cargando checklist preoperacional‚Ä¶"></div>
        <div style="position:absolute; bottom:40px; color:#4f46e5; font-weight:500;">
          Cargando formulario de verificaci√≥n...
        </div>
      </div>

      <!-- IFRame con tu Apps Script -->
      <iframe
        id="appscript"
        title="Checklist Preoperacional de Veh√≠culos"
        src="https://script.google.com/macros/s/AKfycbwTruMrYDjXZH1FLvFkNhhASLoqzLrlCS5Sfej42d2U6BuqbkKSSRa9zVWxzcrz8JofCA/exec"
        allow="clipboard-read; clipboard-write; camera; microphone; geolocation; fullscreen"
        referrerpolicy="strict-origin-when-cross-origin"
        scrolling="yes"
        sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-modals allow-popups-to-escape-sandbox"
      ></iframe>
    </div>
  </main>

  <div class="footer">
    Sistema de verificaci√≥n preoperacional de veh√≠culos ‚Ä¢ Combuses ¬© 2025
  </div>

  <script>
    // Elementos principales
    const iframe = document.getElementById('appscript');
    const loader = document.querySelector('.loader');
    
    // Marcar listo y ocultar loader cuando el iframe cargue
    iframe.addEventListener('load', () => {
      setTimeout(() => {
        document.body.classList.add('ready');
        
        // Asegurar que el iframe tenga altura suficiente
        adjustIframeHeight();
        
        // Enviar mensaje al iframe para activar scroll m√≥vil
        try {
          iframe.contentWindow.postMessage({ type: 'enableMobileScroll' }, '*');
        } catch (e) {
          console.log('Comunicaci√≥n con iframe establecida');
        }
      }, 500);
    });
    
    // Funci√≥n para ajustar altura del iframe din√°micamente
    function adjustIframeHeight() {
      // En m√≥viles, usar altura completa
      if (window.innerWidth <= 768) {
        const headerHeight = document.querySelector('header').offsetHeight;
        const footerHeight = document.querySelector('.footer').offsetHeight;
        const viewportHeight = window.innerHeight;
        const calculatedHeight = viewportHeight - headerHeight - footerHeight - 20;
        
        iframe.style.height = Math.max(calculatedHeight, 500) + 'px';
        iframe.style.minHeight = Math.max(calculatedHeight, 500) + 'px';
      } else {
        // En desktop, altura autom√°tica
        iframe.style.height = '100vh';
        iframe.style.minHeight = '600px';
      }
    }
    
    // Escuchar mensajes del iframe para ajuste din√°mico de altura
    window.addEventListener('message', function(event) {
      // Aceptar mensajes de cualquier origen (ya que confiamos en nuestro iframe)
      if (event.data && event.data.type === 'contentHeight') {
        const height = event.data.height;
        if (height && height > 500) {
          iframe.style.height = height + 'px';
        }
      }
    });
    
    // Ajustar en carga inicial
    window.addEventListener('DOMContentLoaded', adjustIframeHeight);
    
    // Reajustar en cambios de tama√±o/orientaci√≥n
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(adjustIframeHeight, 200);
    });
    
    window.addEventListener('orientationchange', () => {
      setTimeout(adjustIframeHeight, 300);
    });
    
    // Fallback: si despu√©s de 5 segundos no se carga, ocultar loader igual
    setTimeout(() => {
      document.body.classList.add('ready');
    }, 5000);
    
    // Mejorar experiencia t√°ctil en m√≥viles
    if ('ontouchstart' in window) {
      // Prevenir zoom con doble toque
      let lastTouchEnd = 0;
      document.addEventListener('touchend', function(event) {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) {
          event.preventDefault();
        }
        lastTouchEnd = now;
      }, { passive: false });
      
      // Asegurar que los elementos sean f√°cilmente tocables
      document.body.style.cursor = 'pointer';
    }
  </script>
</body>
</html>



